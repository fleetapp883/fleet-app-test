(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{22:function(e,t,a){e.exports=a(40)},30:function(e,t,a){},38:function(e,t,a){},40:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),o=a(15),l=a.n(o),c=(a(30),a(21)),s=a(4),d=a(12),i=a(3),m=a(20);const u=Object(m.a)({apiKey:"AIzaSyAOcDXL1kQsi_MoLJ33GWn9-57qhQ0CWro",authDomain:"fleet-9805b.firebaseapp.com",projectId:"fleet-9805b",storageBucket:"fleet-9805b.appspot.com",messagingSenderId:"682529821046",appId:"1:682529821046:web:cbb00f5dcbac062304aa57",measurementId:"G-T4PZQZGWZ9"}),b=Object(d.b)(u),p=Object(i.h)(u),g={container:{minHeight:"100vh",background:"linear-gradient(135deg, #1c2541, #3a506b)",display:"flex",justifyContent:"center",alignItems:"center",padding:"30px"},card:{width:"100%",maxWidth:"400px",background:"#0b132b",padding:"40px 30px",borderRadius:"16px",boxShadow:"0 0 25px rgba(0,0,0,0.3)",textAlign:"center"},logo:{width:"80%",maxWidth:"280px",margin:"0 auto 20px",display:"block"},title:{marginBottom:"20px",color:"#ffffff"},form:{display:"flex",flexDirection:"column",gap:"15px"},input:{padding:"12px",borderRadius:"8px",border:"1px solid #ccc",fontSize:"16px",outline:"none"},submitBtn:{padding:"12px",backgroundColor:"#1c7ed6",color:"#fff",border:"none",borderRadius:"8px",fontSize:"16px",cursor:"pointer"},toggleBtn:{marginTop:"20px",background:"none",border:"none",color:"#74c0fc",cursor:"pointer",fontSize:"14px",textDecoration:"underline"}};var v=()=>{const[e,t]=Object(r.useState)(""),[a,o]=Object(r.useState)(""),[l,c]=Object(r.useState)(!0),[s,i]=Object(r.useState)(!1);return n.a.createElement("div",{style:g.container},n.a.createElement("div",{style:g.card},n.a.createElement("img",{src:"/logo.png",alt:"Logo",style:g.logo}),n.a.createElement("h2",{style:g.title},l?"Login":"Sign Up"),n.a.createElement("form",{onSubmit:async t=>{t.preventDefault(),i(!0);try{l?(await Object(d.d)(b,e,a),alert("\u2705 Login successful!")):(await Object(d.a)(b,e,a),alert("\u2705 Account created successfully!"))}catch(r){alert("\u274c "+r.message)}finally{i(!1)}},style:g.form},n.a.createElement("input",{type:"email",placeholder:"Email Address",value:e,onChange:e=>t(e.target.value),required:!0,style:g.input}),n.a.createElement("input",{type:"password",placeholder:"Password",value:a,onChange:e=>o(e.target.value),required:!0,style:g.input}),n.a.createElement("button",{type:"submit",disabled:s,style:g.submitBtn},s?"Please wait...":l?"Login":"Sign Up")),n.a.createElement("button",{onClick:()=>c(!l),style:g.toggleBtn},l?"New here? Create an account":"Already registered? Login")))},y=(a(18),a(6));const O={date:"",deliveryDate:"",months:"",origin:"",destination:"",customer:"",customerType:"",vehicleNo:"",vendor:"",salesRate:"",buyRate:""},h={toBeAdvance:"",advanceReceived:"",advDeviation:"",advanceRecDate:"",validatedAdvanceUTRDescription:"",validatedAdvanceAmount:"",balance:"",processingCharges:"",inwardMisCharges:"",outwardMisCharges:"",balanceReceived:"",remainingBalance:"",balanceRecDate:"",validatedBalanceUTR:"",validatedBalanceUTRAmount:""},f={vendorOutwardPayment:"",paidAmount:"",balancePending:"",vendorRemark:""},E={podVendorDate:"",podSendToCustomerDate:"",docNo:"",podCustomerRec:"",today:"",balanceOverdueDays:"",toBeCollectedAmount:""};var C=e=>{let{onAddRow:t}=e;const[a,o]=Object(r.useState)(O),[l,c]=Object(r.useState)(h),[d,m]=Object(r.useState)(f),[u,g]=Object(r.useState)(E),[v,C]=Object(r.useState)(null),[D,S]=Object(r.useState)(null),[M,j]=Object(r.useState)(!1),[x,N]=Object(r.useState)(!1),[w,A]=Object(r.useState)(!1),[R,k]=Object(r.useState)(!1),[T,I]=Object(r.useState)(!1),[B,P]=Object(r.useState)(!1);Object(r.useEffect)(()=>{const e=localStorage.getItem("inProgressIndentNumber"),t=localStorage.getItem("fixedFields"),a=localStorage.getItem("customerFields"),r=localStorage.getItem("vendorFields"),n=localStorage.getItem("podFields"),l=localStorage.getItem("docId");l&&S(l),e&&C(Number(e)),t&&o(JSON.parse(t)),a&&c(JSON.parse(a)),r&&m(JSON.parse(r)),n&&g(JSON.parse(n))},[]);const F=e=>"date"===e?"Placement Date":e.replace(/([a-z])([A-Z])/g,"$1 $2").replace(/_/g," ").replace(/^./,e=>e.toUpperCase()),V=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const a={};return Object.entries(e).forEach(e=>{let[r,n]=e;if(t.includes(r)&&n){const e=new Date(n);a[r]=isNaN(e)?n:i.a.fromDate(e)}else a[r]=n}),a},U=e=>{const t=Object(s.a)(Object(s.a)({},a),{},{[e.target.name]:e.target.value});o(t),localStorage.setItem("fixedFields",JSON.stringify(t))},_=(e,t)=>{const{name:a,value:r}=e.target;if("customer"===t){const e=Object(s.a)(Object(s.a)({},l),{},{[a]:r});c(e),localStorage.setItem("customerFields",JSON.stringify(e))}if("vendor"===t){const e=Object(s.a)(Object(s.a)({},d),{},{[a]:r});m(e),localStorage.setItem("vendorFields",JSON.stringify(e))}if("pod"===t){const e=Object(s.a)(Object(s.a)({},u),{},{[a]:r});g(e),localStorage.setItem("podFields",JSON.stringify(e))}},L=async function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(D)try{const n=Object(i.e)(p,"fleet_records",D);await Object(i.k)(n,{["".concat(e)]:V(t,a)}),"customerMaster"===e&&k(!0),"vendorMaster"===e&&I(!0),"podMaster"===e&&P(!0),Object(y.confirmAlert)({title:"Saved",message:"\u2705 ".concat(e," saved."),buttons:[{label:"OK"}]})}catch(r){Object(y.confirmAlert)({title:"Error",message:"\u274c Save error: "+r.message,buttons:[{label:"OK"}]})}else Object(y.confirmAlert)({title:"Missing Info",message:"\u26a0\ufe0f Save fixed fields first.",buttons:[{label:"OK"}]})};return n.a.createElement("div",{style:{marginTop:20}},n.a.createElement("h4",null,"Step 1: Fixed Fields"),n.a.createElement("div",{className:"card p-4 mb-4"},n.a.createElement("div",{className:"fixed-fields-grid",style:{display:"grid",gridTemplateColumns:"repeat(5, 1fr)",gap:"16px"}},Object.keys(O).map(e=>(e.toLowerCase().includes("date")&&"".concat(e," (dd/mm/yyyy)"),n.a.createElement("div",{key:e},n.a.createElement("label",{className:"form-label",style:{fontWeight:"500"}},F(e)),"date"===e||"deliveryDate"===e?n.a.createElement("input",{type:"date",name:e,className:"form-control",value:a[e],onChange:U,disabled:!!v}):n.a.createElement("input",{name:e,className:"form-control",placeholder:"",value:a[e],onChange:U,disabled:!!v,type:"text"}))))),!v&&n.a.createElement("div",{style:{marginTop:"20px",width:"100%",textAlign:"right"}},n.a.createElement("button",{className:"btn btn-primary",onClick:async()=>{if(Object.values(a).some(e=>""!==String(null!==e&&void 0!==e?e:"").trim()))try{const t=b.currentUser,r=await(async()=>{const e=Object(i.e)(p,"Counters","fleet_counter");return await Object(i.j)(p,async t=>{const a=await t.get(e);if(!a.exists())throw new Error("Counter doc missing");const r=a.data().nextFleetNo||1;return t.update(e,{nextFleetNo:r+1}),r})})(),n=Object(s.a)(Object(s.a)({indentNumber:r},V(a,["date","deliveryDate"])),{},{createdAt:new Date,createdBy:(null===t||void 0===t?void 0:t.email)||"anonymous",isCurrent:!0,versionDate:new Date,updateDescription:""}),o=await Object(i.b)(Object(i.c)(p,"fleet_records"),n);C(r),S(o.id),localStorage.setItem("docId",o.id),localStorage.setItem("inProgressIndentNumber",r),await navigator.clipboard.writeText(String(r)),Object(y.confirmAlert)({title:"Success",message:"\u2705 Fixed fields saved. Indent Number copied: ".concat(r),buttons:[{label:"OK"}]})}catch(e){Object(y.confirmAlert)({title:"Error",message:"\u274c Error saving fixed fields: "+e.message,buttons:[{label:"OK"}]})}else Object(y.confirmAlert)({title:"Validation Error",message:"\u26a0\ufe0f Please fill at least one field before continuing.",buttons:[{label:"OK"}]})}},"\ud83d\udcbe Save & Continue"))),v&&n.a.createElement(n.a.Fragment,null,n.a.createElement("p",{style:{color:"green"}},"\u2705 Saved. Indent No: ",v),n.a.createElement("h4",null,"Step 2: Select Master Sections"),n.a.createElement("label",null,n.a.createElement("input",{type:"checkbox",checked:M,onChange:()=>j(!M),disabled:R})," Customer Master"),n.a.createElement("label",{style:{marginLeft:15}},n.a.createElement("input",{type:"checkbox",checked:x,onChange:()=>N(!x),disabled:T})," Vendor Master"),n.a.createElement("label",{style:{marginLeft:15}},n.a.createElement("input",{type:"checkbox",checked:w,onChange:()=>A(!w),disabled:B})," POD Master"),M&&n.a.createElement(n.a.Fragment,null,n.a.createElement("h5",null,"Customer Master"),n.a.createElement("div",{className:"card p-3 mb-3"},n.a.createElement("div",{style:{display:"grid",gridTemplateColumns:"repeat(5, 1fr)",gap:"16px"}},Object.keys(h).map(e=>{const t=["advanceRecDate","balanceRecDate"].includes(e);return t&&"".concat(e," (dd/mm/yyyy)"),n.a.createElement("div",{key:e},n.a.createElement("label",{className:"form-label",style:{fontWeight:"500"}},F(e)),n.a.createElement("input",{name:e,className:"form-control",placeholder:"",value:l[e],onChange:e=>_(e,"customer"),disabled:R,type:t?"date":"text"}))})),!R&&n.a.createElement("div",{style:{textAlign:"right",marginTop:"16px"}},n.a.createElement("button",{className:"btn btn-primary",onClick:()=>L("customerMaster",l,["advanceRecDate","balanceRecDate"])},"Save Customer")))),x&&n.a.createElement(n.a.Fragment,null,n.a.createElement("h5",null,"Vendor Master"),n.a.createElement("div",{className:"card p-3 mb-3"},n.a.createElement("div",{style:{display:"grid",gridTemplateColumns:"repeat(5, 1fr)",gap:"16px"}},Object.keys(f).map(e=>n.a.createElement("div",{key:e},n.a.createElement("label",{className:"form-label",style:{fontWeight:"500"}},F(e)),n.a.createElement("input",{name:e,className:"form-control",placeholder:"",value:d[e],onChange:e=>_(e,"vendor"),disabled:T,type:"text"})))),!T&&n.a.createElement("div",{style:{textAlign:"right",marginTop:"16px"}},n.a.createElement("button",{className:"btn btn-primary mt-3",onClick:()=>L("vendorMaster",d)},"Save Vendor")))),w&&n.a.createElement(n.a.Fragment,null,n.a.createElement("h5",null,"POD Master"),n.a.createElement("div",{className:"card p-3 mb-3"},n.a.createElement("div",{style:{display:"grid",gridTemplateColumns:"repeat(5, 1fr)",gap:"16px"}},Object.keys(E).map(e=>{const t=["podVendorDate","podSendToCustomerDate","podCustomerRec","today"].includes(e);return t&&"".concat(e," (dd/mm/yyyy)"),n.a.createElement("div",{key:e},n.a.createElement("label",{className:"form-label",style:{fontWeight:"500"}},F(e)),n.a.createElement("input",{name:e,className:"form-control",placeholder:"",value:u[e],onChange:e=>_(e,"pod"),disabled:B,type:t?"date":"text"}))})),!B&&n.a.createElement("div",{style:{textAlign:"right",marginTop:"16px"}},n.a.createElement("button",{className:"btn btn-primary mt-3",onClick:()=>L("podMaster",u,["podVendorDate","podSendToCustomerDate","podCustomerRec","today"])},"Save POD")))),n.a.createElement("br",null),n.a.createElement("div",{style:{marginTop:10,width:"100%",textAlign:"right"}},n.a.createElement("button",{onClick:async()=>{if(!D)return void Object(y.confirmAlert)({title:"Error",message:"Fleet data not ready.",buttons:[{label:"OK"}]});M&&!R&&await L("customerMaster",l,["advanceRecDate","balanceRecDate"]),x&&!T&&await L("vendorMaster",d),w&&!B&&await L("podMaster",u,["podVendorDate","podSendToCustomerDate","podCustomerRec","today"]);const e=await Object(i.f)(Object(i.e)(p,"fleet_records",D));if(!e.exists())return void Object(y.confirmAlert)({title:"Error",message:"Data not found.",buttons:[{label:"OK"}]});const a=Object(s.a)({id:e.id},e.data());t(a,!0),localStorage.setItem("latestSearchField","indentNumber"),localStorage.setItem("latestSearchKey",String(a.indentNumber)),o(O),c(h),m(f),g(E),C(null),S(null),j(!1),N(!1),A(!1),k(!1),I(!1),P(!1),localStorage.removeItem("fixedFields"),localStorage.removeItem("customerFields"),localStorage.removeItem("vendorFields"),localStorage.removeItem("podFields"),localStorage.removeItem("inProgressIndentNumber"),localStorage.removeItem("docId"),Object(y.confirmAlert)({title:"Done",message:"\u2705 Record submitted and ready in editable table.",buttons:[{label:"OK"}]})},className:"btn btn-success me-2"},"\u2705 Submit Record"),n.a.createElement("button",{onClick:()=>{Object(y.confirmAlert)({title:"Confirm New Entry",message:"Start a new entry? Unsaved data will be lost.",buttons:[{label:"Yes",onClick:()=>{o(O),c(h),m(f),g(E),C(null),S(null),j(!1),N(!1),A(!1),k(!1),I(!1),P(!1),localStorage.removeItem("fixedFields"),localStorage.removeItem("customerFields"),localStorage.removeItem("vendorFields"),localStorage.removeItem("podFields"),localStorage.removeItem("inProgressIndentNumber"),localStorage.removeItem("docId"),Object(y.confirmAlert)({title:"Ready",message:"\ud83c\udd95 Ready to start a new record.",buttons:[{label:"OK"}]})}},{label:"No"}]})},className:"btn btn-primary"},"\u2795 Add New Record"))))},D=a(10);const S=["placementDate","deliveryDate","customerMaster.advanceRecDate","customerMaster.balanceRecDate","podMaster.podVendorDate","podMaster.podSendToCustomerDate","podMaster.podCustomerRec","podMaster.today"],M={"Placement Date":"placementDate","Delivery Date":"deliveryDate",Month:"months",Origin:"origin",Destination:"destination",Customer:"customer","Customer Type":"customerType","Vehicle Number":"vehicleNo",Vendor:"vendor","Sales Rate":"salesRate","Buy Rate":"buyRate","Customer -> To be Advance (Sales)":"customerMaster.toBeAdvance","Customer -> Advance / Payment Received":"customerMaster.advanceReceived","Customer -> Adv Deviation (as on Date)":"customerMaster.advDeviation","Customer -> Advance Rec Date":"customerMaster.advanceRecDate","Customer -> Validated-Advance UTR Description":"customerMaster.validatedAdvanceUTRDescription","Customer -> Validated UTR - Advance Amount":"customerMaster.validatedAdvanceAmount","Customer -> Balance":"customerMaster.balance","Customer -> Processing Charges":"customerMaster.processingCharges","Customer -> Inward-Mis Charges":"customerMaster.inwardMisCharges","Customer -> Outward-Mis Charges":"customerMaster.outwardMisCharges","Customer -> Bal Received":"customerMaster.balanceReceived","Customer -> Remaining Balance":"customerMaster.remainingBalance","Customer -> Balance Rec Date":"customerMaster.balanceRecDate","Customer -> Validated-Balance UTR":"customerMaster.validatedBalanceUTR","Customer -> Validate Balance UTR-Amount":"customerMaster.validatedBalanceUTRAmount","Vendor -> Outward Payment":"vendorMaster.vendorOutwardPayment","Vendor -> Paid Amount":"vendorMaster.paidAmount","Vendor -> Balance Pending":"vendorMaster.balancePending","Vendor -> Vendor Remark":"vendorMaster.vendorRemark","POD -> POD Vendor-Date":"podMaster.podVendorDate","POD -> POD-Send to Customer Date":"podMaster.podSendToCustomerDate","POD -> Doc No":"podMaster.docNo","POD -> POD-Customer Rec":"podMaster.podCustomerRec","POD -> Today":"podMaster.today","POD -> Balance Overdue Days":"podMaster.balanceOverdueDays","POD -> To be Collected Amount":"podMaster.toBeCollectedAmount"};var j=()=>{const[e,t]=Object(r.useState)([]),[a,o]=Object(r.useState)({}),[l,c]=Object(r.useState)({}),d=e=>{const a=new FileReader;a.onload=(e=>{const a=D.a(e.target.result,{type:"binary"}),r=a.Sheets[a.SheetNames[0]],n=D.b.sheet_to_json(r,{header:1,defval:"",blankrows:!1}),l=n[0],s=n.slice(1).map(e=>{const t={};return l.forEach((a,r)=>{const n=(e=>M[e.trim()]||null)(a);n&&(t[n]=e[r])}),t});t(s),o({}),c({})}),a.readAsBinaryString(e)},m=async(e,t)=>{const a=b.currentUser;try{const n=await(async()=>{const e=Object(i.e)(p,"Counters","fleet_counter");return await Object(i.j)(p,async t=>{const a=(await t.get(e)).data().nextFleetNo||1;return t.update(e,{nextFleetNo:a+1}),a})})(),l=Object(s.a)({},e);Object.keys(l).forEach(e=>{if("string"===typeof l[e]&&l[e].match(/^\d{2}-\d{2}-\d{4}$/)){const t=(e=>{const[t,a,r]=e.split("-");return t&&a&&r?new Date(Number(r),Number(a)-1,Number(t)):null})(l[e]);t instanceof Date&&!isNaN(t)&&(l[e]=t)}}),l.placementDate&&!l.date&&(l.date=l.placementDate);const d=Object(s.a)(Object(s.a)({},l),{},{indentNumber:n,createdAt:new Date,createdBy:(null===a||void 0===a?void 0:a.email)||"anonymous",isCurrent:!0,versionDate:new Date});await Object(i.b)(Object(i.c)(p,"fleet_records"),d),o(e=>Object(s.a)(Object(s.a)({},e),{},{[t]:"\u2705 Saved"})),c(e=>Object(s.a)(Object(s.a)({},e),{},{[t]:n}))}catch(r){o(e=>Object(s.a)(Object(s.a)({},e),{},{[t]:"\u274c Failed"}))}};return n.a.createElement("div",{style:{marginBottom:40}},n.a.createElement("h4",null,"Upload Excel & Preview"),n.a.createElement("div",{style:{display:"flex",alignItems:"center",gap:"10px"}},n.a.createElement("input",{type:"file",accept:".xlsx, .xls",onChange:e=>{var t;const a=null===(t=e.target.files)||void 0===t?void 0:t[0];a&&(d(a),setTimeout(()=>{e.target.value=""},100))}}),n.a.createElement("button",{onClick:()=>{const e=Object.keys(M),t={};e.forEach(e=>{const a=M[e];S.includes(a)?t[e]="01-01-2025":"month"===e.toLowerCase()||e.toLowerCase().includes("month")?t[e]="July-2025":e.toLowerCase().includes("rate")||e.toLowerCase().includes("amount")?t[e]="10000":e.toLowerCase().includes("number")||e.toLowerCase().includes("no")?t[e]="ABC123":t[e]="Sample"});const a=D.b.json_to_sheet([t]),r=D.b.book_new();D.b.book_append_sheet(r,a,"Template"),D.c(r,"FleetUploadTemplate.xlsx")}},"\u2b07\ufe0f Download Template")),e.length>0&&n.a.createElement(n.a.Fragment,null,n.a.createElement("h5",{style:{marginTop:20}},"\ud83d\udcc4 Preview Table (Excel Upload)"),n.a.createElement("button",{onClick:async()=>{for(let t=0;t<e.length;t++)a[t]||await m(e[t],t)}},"\ud83d\udcbe Save All"),n.a.createElement("button",{onClick:()=>{t([]),o({}),c({})},style:{marginLeft:10,color:"red"}},"\ud83e\uddf9 Clear"),n.a.createElement("div",{className:"table-scroll-x"},n.a.createElement("table",null,n.a.createElement("thead",null,n.a.createElement("tr",null,n.a.createElement("th",null,"Fleet Number"),Object.keys(e[0]).map(e=>n.a.createElement("th",{key:e},e)),n.a.createElement("th",null,"Status"),n.a.createElement("th",null,"Action"))),n.a.createElement("tbody",null,e.map((r,d)=>n.a.createElement("tr",{key:d},n.a.createElement("td",null,l[d]||""),Object.keys(r).map(a=>n.a.createElement("td",{key:a},n.a.createElement("input",{type:S.includes(a)?"date":"text",value:S.includes(a)&&r[a]?(()=>{try{const t=new Date(r[a]);return isNaN(t.getTime())?"":new Date(t.getTime()-6e4*t.getTimezoneOffset()).toISOString().split("T")[0]}catch(e){return""}})():r[a],onChange:r=>((a,r,n)=>{const o=[...e];o[a][r]=n,t(o)})(d,a,r.target.value),style:{width:"120px"}}))),n.a.createElement("td",null,a[d]||"\u23f3 Pending"),n.a.createElement("td",null,n.a.createElement("button",{onClick:()=>m(r,d),disabled:"\u2705 Saved"===a[d]},"Save"),n.a.createElement("button",{onClick:()=>(r=>{t(e.filter((e,t)=>t!==r));const n=Object(s.a)({},a);delete n[r];const d=Object(s.a)({},l);delete d[r],o(n),c(d)})(d),style:{marginLeft:6,color:"red"}},"Delete")))))))))},x=(a(38),a(8));a(39);const N=["id","indentNumber"],w=["date","deliveryDate","createdAt","versionDate","expiredAt","customerMaster.advanceRecDate","customerMaster.balanceRecDate","customerMaster.advDeviation","customerMaster.validatedAdvanceUTRDescription","customerMaster.validatedAdvanceAmount","customerMaster.validatedBalanceUTR","customerMaster.validatedBalanceUTRAmount","podMaster.podVendorDate","podMaster.podSendToCustomerDate","podMaster.podCustomerRec","podMaster.today"],A=["indentNumber","date","deliveryDate","months","origin","destination","customer","customerType","vehicleNo","vendor","salesRate","buyRate","createdAt","createdBy","versionDate","isCurrent","updateDescription","expiredAt","customerMaster.toBeAdvance","customerMaster.advanceReceived","customerMaster.advDeviation","customerMaster.advanceRecDate","customerMaster.validatedAdvanceUTRDescription","customerMaster.validatedAdvanceAmount","customerMaster.balance","customerMaster.processingCharges","customerMaster.inwardMisCharges","customerMaster.outwardMisCharges","customerMaster.balanceReceived","customerMaster.remainingBalance","customerMaster.balanceRecDate","customerMaster.validatedBalanceUTR","customerMaster.validatedBalanceUTRAmount","vendorMaster.vendorOutwardPayment","vendorMaster.paidAmount","vendorMaster.balancePending","vendorMaster.vendorRemark","podMaster.podVendorDate","podMaster.podSendToCustomerDate","podMaster.docNo","podMaster.podCustomerRec","podMaster.today","podMaster.balanceOverdueDays","podMaster.toBeCollectedAmount"],R={indentNumber:"Indent Number",date:"Placement Date",deliveryDate:"Delivery Date",months:"Month",origin:"Origin",destination:"Destination",customer:"Customer",customerType:"Customer Type",vehicleNo:"Vehicle Number",vendor:"Vendor",salesRate:"Sales Rate",buyRate:"Buy Rate",createdAt:"Created At",createdBy:"Created By",versionDate:"Version Date",isCurrent:"Is Current",updateDescription:"Update Description",expiredAt:"Expired At","customerMaster.toBeAdvance":"Customer Master -> To be Advance (Sales)","customerMaster.advanceReceived":"Customer Master -> Advance / Payment Received","customerMaster.advDeviation":"Customer Master -> Adv Deviation (as on Date)","customerMaster.advanceRecDate":"Customer Master -> Advance Rec Date","customerMaster.validatedAdvanceUTRDescription":"Customer Master -> Validated-Advance UTR Description","customerMaster.validatedAdvanceAmount":"Customer Master -> Validated UTR - Advance Amount","customerMaster.balance":"Customer Master -> Balance","customerMaster.processingCharges":"Customer Master -> Processing Charges","customerMaster.inwardMisCharges":"Customer Master -> Inward-Mis Charges","customerMaster.outwardMisCharges":"Customer Master -> Outward-Mis Charges","customerMaster.balanceReceived":"Customer Master -> Bal Received","customerMaster.remainingBalance":"Customer Master -> Remaining Balance","customerMaster.balanceRecDate":"Customer Master -> Balance Rec Date","customerMaster.validatedBalanceUTR":"Customer Master -> Validated-Balance UTR","customerMaster.validatedBalanceUTRAmount":"Customer Master -> Validate Balance UTR-Amount","vendorMaster.vendorOutwardPayment":"Vendor Master -> Outward Payment","vendorMaster.paidAmount":"Vendor Master -> Paid Amount","vendorMaster.balancePending":"Vendor Master -> Balance Pending","vendorMaster.vendorRemark":"Vendor Master -> Vendor Remark","podMaster.podVendorDate":"POD Master -> POD Vendor-Date","podMaster.podSendToCustomerDate":"POD Master -> POD-Send to Customer Date","podMaster.docNo":"POD Master -> Doc No","podMaster.podCustomerRec":"POD Master -> POD-Customer Rec","podMaster.today":"POD Master -> Today","podMaster.balanceOverdueDays":"POD Master -> Balance Overdue Days","podMaster.toBeCollectedAmount":"POD Master -> To be Collected Amount"},k=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a={};for(const r in e){const n=e[r],o=t?"".concat(t,".").concat(r):r;n&&"object"===typeof n&&!n.seconds?Object.assign(a,k(n,o)):a[o]=n}return a};var T=function(){const[e,t]=Object(r.useState)(null),[a,o]=Object(r.useState)(!0),[l,m]=Object(r.useState)([]),[u,g]=Object(r.useState)([]),[O,h]=Object(r.useState)(""),[f,E]=Object(r.useState)("indentNumber"),[S,M]=Object(r.useState)(""),[T,I]=Object(r.useState)(""),[B,P]=Object(r.useState)({}),[F,V]=Object(r.useState)(!1),[U,_]=Object(r.useState)(!1),[L,J]=Object(r.useState)(!1),[W,K]=Object(r.useState)(!1),[z,G]=Object(r.useState)(!1),[Z,q]=Object(r.useState)(!1),[Q,Y]=Object(r.useState)(!1);Object(r.useEffect)(()=>{const e=Object(d.c)(b,e=>{t(e),o(!1)});return()=>e()},[]);const $=async()=>{V(!0);try{const t=Object(i.c)(p,"fleet_records");let a;if("Date"===f){const e=new Date(S),r=new Date(T+"T23:59:59");if(e>r)return x.b.warn("\u26a0\ufe0f 'From' date cannot be after 'To' date."),void V(!1);a=Object(i.i)(t,...W?[Object(i.l)("isCurrent","==",!0)]:[],Object(i.l)("createdAt",">=",e),Object(i.l)("createdAt","<=",r))}else{if(!O)return x.b.warn("\ud83d\udd0d Please enter a search value."),void V(!1);{const e="indentNumber"===f?Number(O):O;a=Object(i.i)(t,Object(i.l)(f,"==",e),...W?[Object(i.l)("isCurrent","==",!0)]:[])}}J(!0);const r=await Object(i.g)(a),n=[],o=[];r.forEach(e=>{const t=Object(s.a)({id:e.id},e.data()),a=k(t);n.push(a),a.isCurrent&&o.push(a)}),n.sort((e,t)=>e.isCurrent&&!t.isCurrent?-1:!e.isCurrent&&t.isCurrent?1:t.indentNumber-e.indentNumber),o.sort((e,t)=>t.indentNumber-e.indentNumber),"indentNumber"===f?(m(o),g(n.map(e=>JSON.parse(JSON.stringify(e))))):(m([]),g(n.map(e=>JSON.parse(JSON.stringify(e))))),(r.empty||0===n.length)&&x.b.info("\u274c No records found.")}catch(e){x.b.error("\u274c Search failed: "+e.message)}finally{V(!1)}};return a?n.a.createElement("p",{style:{textAlign:"center"}},"Checking authentication..."):e?n.a.createElement("div",{style:{maxWidth:"100vw",overflowX:"hidden",padding:"40px 20px"}},n.a.createElement("div",{className:"header"},n.a.createElement("h2",null,"Fleet Billing Dashboard"),n.a.createElement("div",{style:{display:"flex",alignItems:"center"}},n.a.createElement("span",{className:"user-email"},"Welcome, ",e.email),n.a.createElement("img",{src:"/logo.png",alt:"Logo",style:{height:"50px"}}))),n.a.createElement("button",{onClick:()=>{localStorage.removeItem("inProgressFleetNumber"),localStorage.removeItem("docId"),localStorage.removeItem("fixedFields"),localStorage.removeItem("customerFields"),localStorage.removeItem("vendorFields"),localStorage.removeItem("podFields"),Object(d.e)(b)}},"Logout"),n.a.createElement("hr",null),n.a.createElement(j,null),n.a.createElement(C,{onAddRow:(e,t)=>{const a=k(e);w.forEach(e=>{const t=a[e];t instanceof Date&&!isNaN(t)?a[e]={seconds:Math.floor(t.getTime()/1e3)}:t&&"object"===typeof t&&t.seconds||(a[e]=null)});const r=Object(s.a)({},e);w.forEach(e=>{r[e]=a[e]}),m([r]),t&&g([JSON.parse(JSON.stringify(r))]),P({[e.indentNumber]:JSON.parse(JSON.stringify(r))}),E("indentNumber"),h(String(e.indentNumber)),J(!0),K(!1)}}),n.a.createElement("hr",null),n.a.createElement("h4",null,"Search Existing Records"),n.a.createElement("div",{style:{display:"flex",flexWrap:"wrap",gap:"10px",alignItems:"center",justifyContent:"space-between",width:"100%"}},n.a.createElement("div",{style:{display:"flex",gap:"10px",flexWrap:"wrap",alignItems:"center"}},n.a.createElement("select",{value:f,onChange:e=>{E(e.target.value),h(""),M(""),I("")}},n.a.createElement("option",{value:"indentNumber"},"Indent Number"),n.a.createElement("option",{value:"Broker"},"Broker"),n.a.createElement("option",{value:"Date"},"Date")),"Date"===f?n.a.createElement(n.a.Fragment,null,n.a.createElement("label",null,"From:"),n.a.createElement("input",{type:"date",value:S,onChange:e=>M(e.target.value)}),n.a.createElement("label",null,"To:"),n.a.createElement("input",{type:"date",value:T,onChange:e=>I(e.target.value)})):n.a.createElement("input",{type:"text",value:O,onChange:e=>h(e.target.value),placeholder:"Search key",style:{flex:1,width:"250px"}}),n.a.createElement("div",{style:{display:"flex",alignItems:"center",gap:"10px"}},n.a.createElement("label",{style:{display:"flex",alignItems:"center",fontSize:"14px",marginBottom:0}},n.a.createElement("input",{type:"checkbox",checked:W,onChange:e=>K(e.target.checked),style:{marginRight:"5px"}}),"Show only active")),n.a.createElement("button",{className:"btn btn-primary",onClick:$,disabled:F},F?"Searching...":"Search"))),n.a.createElement("hr",null),"indentNumber"===f&&l.length>0&&n.a.createElement(n.a.Fragment,null,n.a.createElement("h4",null,"Editable Current Records"),n.a.createElement("div",{className:"table-scroll-x"},n.a.createElement("table",null,n.a.createElement("thead",null,n.a.createElement("tr",null,A.map(e=>n.a.createElement("th",{key:e},R[e]||e)),n.a.createElement("th",null,"Action"))),n.a.createElement("tbody",null,l.map((t,a)=>n.a.createElement("tr",{key:a},A.map((e,r)=>{var o;return n.a.createElement("td",{key:r},n.a.createElement("input",{type:w.includes(e)?"date":"text",value:w.includes(e)&&t[e]?(()=>{try{var a;const n=new Date(1e3*(null===(a=t[e])||void 0===a?void 0:a.seconds)||t[e]);return isNaN(n.getTime())?"":new Date(n.getTime()-6e4*n.getTimezoneOffset()).toISOString().split("T")[0]}catch(r){return""}})():null!==(o=t[e])&&void 0!==o?o:"",onChange:t=>{const r=[...l],n=t.target.value;w.includes(e)?r[a][e]=n?new Date(n):"":r[a][e]=n,m(r)},readOnly:["indentNumber","createdAt","createdBy","isCurrent","updateDescription","versionDate","expiredAt"].includes(e),style:{width:"140px"}}))}),n.a.createElement("td",null,n.a.createElement("button",{className:"save",onClick:()=>(async t=>{try{const{id:o,indentNumber:l}=t,d=Object(c.a)(t,N),m=(await Object(i.g)(Object(i.i)(Object(i.c)(p,"fleet_records"),Object(i.l)("indentNumber","==",l),Object(i.l)("isCurrent","==",!0)))).docs.find(e=>e.id===o),u=k((null===m||void 0===m?void 0:m.data())||{}),b={},g=[];for(const e in d){var a,r;if(["id","isCurrent","createdAt","createdBy","versionDate","updateDescription","expiredAt"].includes(e))continue;const t=null!==(a=d[e])&&void 0!==a?a:"",n=null!==(r=u[e])&&void 0!==r?r:"";b[e]=t,String(t).trim()!==String(n).trim()&&g.push("Updated ".concat(e))}return 0===g.length?void x.b.info("\u2139\ufe0f No changes to update."):void Object(y.confirmAlert)({title:"Confirm Update",message:"Do you want to update changes: ".concat(g.join(", "),"?"),buttons:[{label:"Yes",onClick:async()=>{const t=k(m.data());await Object(i.k)(Object(i.e)(p,"fleet_records",o),Object(s.a)(Object(s.a)({},t),{},{isCurrent:!1,expiredAt:new Date,modifiedBy:e.email}));const a=Object(s.a)(Object(s.a)({},b),{},{indentNumber:l,createdAt:new Date,createdBy:e.email,isCurrent:!0,versionDate:new Date,updateDescription:g.join(", ")});await Object(i.b)(Object(i.c)(p,"fleet_records"),a),E("indentNumber"),h(String(l)),J(!0),K(!1),x.b.success("\u2705 Record updated."),setTimeout(()=>{$()},500)}},{label:"No"}]})}catch(n){x.b.error("\u274c Update failed: "+n.message)}})(t)},"Save"),n.a.createElement("button",{className:"delete",onClick:()=>(async e=>{try{const a=Object(i.i)(Object(i.c)(p,"fleet_records"),Object(i.l)("indentNumber","==",e)),r=await Object(i.g)(a);return r.empty?void x.b.error("\u274c No records found for deletion."):void Object(y.confirmAlert)({title:"Confirm Deletion",message:"Delete all versions of Indent No. ".concat(e,"?"),buttons:[{label:"Yes",onClick:async()=>{await Promise.all(r.docs.map(e=>Object(i.d)(Object(i.e)(p,"fleet_records",e.id)))),m(t=>t.filter(t=>t.indentNumber!==e)),g(t=>t.filter(t=>t.indentNumber!==e)),x.b.success("\u2705 Deleted all versions.")}},{label:"No"}]})}catch(t){x.b.error("\u274c Delete failed: "+t.message)}})(t.indentNumber)},"Delete")))))))),u.length>0&&n.a.createElement(n.a.Fragment,null,n.a.createElement("hr",null),n.a.createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},n.a.createElement("h4",null,"\ud83d\udd0d Full Version History"),n.a.createElement("div",{style:{display:"flex",gap:"20px",alignItems:"center"}},n.a.createElement("label",null,n.a.createElement("input",{type:"checkbox",checked:z,onChange:e=>G(e.target.checked)}),"Include Customer"),n.a.createElement("label",null,n.a.createElement("input",{type:"checkbox",checked:Z,onChange:e=>q(e.target.checked)}),"Include Vendor"),n.a.createElement("label",null,n.a.createElement("input",{type:"checkbox",checked:Q,onChange:e=>Y(e.target.checked)}),"Include POD"),n.a.createElement("button",{onClick:()=>{if(0===u.length)return void x.b.info("\u274c No history data to export.");const e=A.slice(0,17),t=A.slice(17,32),a=A.slice(32,36),r=A.slice(36),n=[...e,...z?t:[],...Z?a:[],...Q?r:[]],o=u.map(e=>{const t={};return n.forEach(a=>{const r=e[a];t[a]=w.includes(a)&&(null===r||void 0===r?void 0:r.seconds)?new Date(1e3*r.seconds).toLocaleDateString("en-GB"):(null===r||void 0===r?void 0:r.seconds)?new Date(1e3*r.seconds).toLocaleString():null!==r&&void 0!==r?r:""}),t}),l=D.b.json_to_sheet(o),c=D.b.book_new();D.b.book_append_sheet(c,l,"Filtered Export");const s="FilteredExport_".concat((new Date).toISOString().split("T")[0],".xlsx");D.c(c,s)},disabled:0===u.length,className:"export-button"},"\u2b07\ufe0f Export Selected"))),n.a.createElement("div",{className:"table-scroll-x"},n.a.createElement("table",null,n.a.createElement("thead",null,n.a.createElement("tr",null,A.map(e=>n.a.createElement("th",{key:e,className:"tight-header"},R[e]||e)))),n.a.createElement("tbody",null,[...u].sort((e,t)=>{var a,r;if(e.isCurrent)return-1;if(t.isCurrent)return 1;const n=(null===(a=e.expiredAt)||void 0===a?void 0:a.seconds)||0;return((null===(r=t.expiredAt)||void 0===r?void 0:r.seconds)||0)-n}).map((e,t)=>n.a.createElement("tr",{key:t},A.map((t,a)=>{var r,o,l;return n.a.createElement("td",{key:a},w.includes(t)&&(null===(r=e[t])||void 0===r?void 0:r.seconds)?new Date(1e3*e[t].seconds).toLocaleDateString("en-GB"):"object"===typeof e[t]&&(null===(o=e[t])||void 0===o?void 0:o.seconds)?new Date(1e3*e[t].seconds).toLocaleString():String(null!==(l=e[t])&&void 0!==l?l:""))}))))))),L&&!F&&0===l.length&&0===u.length&&n.a.createElement("p",{style:{textAlign:"center",color:"#888",marginTop:"30px"}},"No records to display."),n.a.createElement(x.a,{position:"bottom-right",autoClose:3e3}),n.a.createElement("p",{style:{textAlign:"center",marginTop:"30px",color:"#666"}},"\xa9 2025 Fleet Billing System")):n.a.createElement(v,null)};var I=e=>{e&&e instanceof Function&&a.e(3).then(a.bind(null,41)).then(t=>{let{getCLS:a,getFID:r,getFCP:n,getLCP:o,getTTFB:l}=t;a(e),r(e),n(e),o(e),l(e)})};l.a.createRoot(document.getElementById("root")).render(n.a.createElement(n.a.StrictMode,null,n.a.createElement(T,null))),I()}},[[22,1,2]]]);
//# sourceMappingURL=main.cb7b92ac.chunk.js.map