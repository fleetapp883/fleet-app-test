{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\anupp\\\\Downloads\\\\fleet-billing-app\\\\fleet-billing-app\\\\src\\\\App.js\";\nimport React, { useEffect, useState } from \"react\";\nimport { onAuthStateChanged, signOut } from \"firebase/auth\";\nimport { collection, addDoc, query, where, getDocs, getDoc, updateDoc, deleteDoc, doc } from \"firebase/firestore\";\nimport { auth, db } from \"./firebase\";\nimport Auth from \"./components/Auth\";\nimport UploadForm from \"./components/UploadForm\";\nimport ManualEntryForm from \"./components/ManualEntryForm\";\nimport \"./App.css\";\nimport { toast, ToastContainer } from \"react-toastify\";\nimport \"react-toastify/dist/ReactToastify.css\";\nconst labelToKey = {\n  \"Fleet Number\": \"fleetNumber\",\n  \"Indent No\": \"IndentNo\",\n  \"Indent Date\": \"IndentDate\",\n  \"Placement Date\": \"PlacementDate\",\n  \"Customer\": \"Customer\",\n  \"Customer Type\": \"CustomerType\",\n  \"Customer Billing Type\": \"CustomerBillingType\",\n  \"Sourcing (Vendor)\": \"SourcingVendor\",\n  \"Vendor Type\": \"VendorType\",\n  \"Vendor Billing Type\": \"VendorBillingType\",\n  \"Origin\": \"Origin\",\n  \"Destination\": \"Destination\",\n  \"Vehicle No\": \"VehicleNo\",\n  \"Vehicle type\": \"VehicleType\",\n  \"Driver No\": \"DriverNo\",\n  \"Dispatch Date\": \"DispatchDate\",\n  \"Deliver Date\": \"DeliverDate\",\n  \"Offloading Date\": \"OffloadingDate\",\n  \"E-way Bill\": \"EwayBill\",\n  \"LR No.\": \"LRNo\",\n  \"Soft Copy POD Rec\": \"SoftCopyPODRec\",\n  \"Hard Copy POD Rec\": \"HardCopyPODRec\",\n  \"Customer -Sale rate\": \"CustomerSaleRate\",\n  \"Advance to be Paid\": \"AdvanceToBePaid\",\n  \"Advance Rec\": \"AdvanceRec\",\n  \"Advance UTR\": \"AdvanceUTR\",\n  \"Advance Rec-Date\": \"AdvanceRecDate\",\n  \"Balance Pending\": \"BalancePending\",\n  \"Detention Charges\": \"DetentionCharges\",\n  \"Loading/Unloading Charges\": \"LoadingUnloadingCharges\",\n  \"Miscellaneous Charges.\": \"MiscCharges\",\n  \"Processing Charges\": \"ProcessingCharges\",\n  \"Net Balance\": \"NetBalance\",\n  \"Balance Rec Amount\": \"BalanceRecAmount\",\n  \"Balance UTR\": \"BalanceUTR\",\n  \"Balance Rec Date\": \"BalanceRecDate\",\n  \"Remaining Balance\": \"RemainingBalance\",\n  \"Remaining Balance UTR\": \"RemainingBalanceUTR\",\n  \"Remaining Balance Date\": \"RemainingBalanceDate\",\n  \"Supplier Buy Rate\": \"SupplierBuyRate\",\n  \"Supplier Advance Pay\": \"SupplierAdvancePay\",\n  \"Supplier Advance Paid\": \"SupplierAdvancePaid\",\n  \"Supplier Mis Charges\": \"SupplierMisCharges\",\n  \"Supplier Invoice No.\": \"SupplierInvoiceNo\",\n  \"Supplier Advance UTR\": \"SupplierAdvanceUTR\",\n  \"Supplier Advance Pay-Date\": \"SupplierAdvancePayDate\",\n  \"Supplier Balance Pending\": \"SupplierBalancePending\",\n  \"Supplier Balance Paid Amount\": \"SupplierBalancePaidAmount\",\n  \"Supplier Balance Paid UTR\": \"SupplierBalancePaidUTR\",\n  \"Supplier Balance Paid Date\": \"SupplierBalancePaidDate\",\n  \"Remaining Supplier Amount\": \"RemainingSupplierAmount\",\n  \"POD Rec Date\": \"PODRecDate\",\n  \"POD Send to Customer Date\": \"PODSendToCustomerDate\",\n  \"POD Docket No.\": \"PODDocketNo\",\n  \"POD Rec By Customer\": \"PODRecByCustomer\",\n  \"POD Deduction If any\": \"PODDeductionIfAny\",\n  \"Gross Profit\": \"GrossProfit\",\n  \"Bad Debts\": \"BadDebts\",\n  \"Net Profit\": \"NetProfit\",\n  \"isCurrent\": \"isCurrent\",\n  \"createdBy\": \"createdBy\",\n  \"createdAt\": \"createdAt\",\n  \"Update Description\": \"updateDescription\"\n};\nconst keyToLabel = Object.fromEntries(Object.entries(labelToKey).map(([k, v]) => [v, k]));\nfunction App() {\n  const [user, setUser] = useState(null);\n  const [records, setRecords] = useState([]);\n  const [history, setHistory] = useState([]);\n  const [searchKey, setSearchKey] = useState(\"\");\n  const [searchField, setSearchField] = useState(\"fleetNumber\");\n  const [startDate, setStartDate] = useState(\"\");\n  const [endDate, setEndDate] = useState(\"\");\n  const [originalRecords, setOriginalRecords] = useState({});\n  const [isSearching, setIsSearching] = useState(false);\n  const [isExporting, setIsExporting] = useState(false);\n  const [searchAttempted, setSearchAttempted] = useState(false);\n  useEffect(() => {\n    const unsubscribe = onAuthStateChanged(auth, currentUser => {\n      setUser(currentUser);\n    });\n    return () => unsubscribe();\n  }, []);\n\n  // const handleExport = () => {\n  //   import(\"xlsx\").then((xlsx) => {\n  //     const rows = history.map((row) => {\n  //       const flatRow = {};\n  //       Object.keys(row).forEach((k) => {\n  //         const value = row[k];\n  //         flatRow[k] =\n  //           typeof value === \"object\" && value?.seconds\n  //             ? new Date(value.seconds * 1000).toLocaleString()\n  //             : String(value ?? \"\");\n  //       });\n  //       return flatRow;\n  //     });\n\n  //     const worksheet = xlsx.utils.json_to_sheet(rows);\n  //     const workbook = xlsx.utils.book_new();\n  //     xlsx.utils.book_append_sheet(workbook, worksheet, \"History\");\n  //     xlsx.writeFile(workbook, \"Fleet_Full_Version_History.xlsx\");\n  //   });\n  // };\n  const handleExport = () => {\n    setIsExporting(true);\n    toast.info(\"‚è≥ Preparing Excel export...\");\n    import(\"xlsx\").then(xlsx => {\n      const rows = history.map(row => {\n        const flatRow = {};\n        Object.keys(row).forEach(k => {\n          const value = row[k];\n          flatRow[k] = typeof value === \"object\" && (value === null || value === void 0 ? void 0 : value.seconds) ? new Date(value.seconds * 1000).toLocaleString() : String(value !== null && value !== void 0 ? value : \"\");\n        });\n        return flatRow;\n      });\n      const worksheet = xlsx.utils.json_to_sheet(rows);\n      const workbook = xlsx.utils.book_new();\n      xlsx.utils.book_append_sheet(workbook, worksheet, \"History\");\n      xlsx.writeFile(workbook, \"Fleet_Full_Version_History.xlsx\");\n      toast.success(\"‚úÖ Export complete.\");\n    }).catch(err => {\n      toast.error(\"‚ùå Export failed: \" + err.message);\n    }).finally(() => {\n      setIsExporting(false);\n    });\n  };\n  const handleSearch = async () => {\n    setIsSearching(true);\n    try {\n      const fleetRef = collection(db, \"fleet_records\");\n      let q;\n      if (searchField === \"Date\") {\n        if (!startDate || !endDate) {\n          toast.warn(\"üìÖ Please select both From and To dates.\");\n          setIsSearching(false);\n          return;\n        }\n        const fromDate = new Date(startDate);\n        const toDate = new Date(endDate + \"T23:59:59\");\n        if (fromDate > toDate) {\n          toast.warn(\"‚ö†Ô∏è 'From' date cannot be after 'To' date.\");\n          setIsSearching(false);\n          return;\n        }\n        q = query(fleetRef, where(\"createdAt\", \">=\", fromDate), where(\"createdAt\", \"<=\", toDate));\n      } else if (searchKey) {\n        const key = searchField === \"fleetNumber\" ? Number(searchKey) : searchKey;\n        q = query(fleetRef, where(searchField, \"==\", key));\n      } else {\n        toast.warn(\"üîç Please enter a search value.\");\n        setIsSearching(false);\n        return;\n      }\n      setSearchAttempted(true);\n      const snapshot = await getDocs(q);\n      const allVersions = [];\n      const currentOnly = [];\n      snapshot.forEach(docSnap => {\n        const row = {\n          id: docSnap.id,\n          ...docSnap.data()\n        };\n        allVersions.push(row);\n        if (row.isCurrent) currentOnly.push(row);\n      });\n      if (searchField === \"fleetNumber\" || searchField === \"Broker\") {\n        setRecords(currentOnly);\n        setHistory(allVersions);\n      } else if (searchField === \"Date\") {\n        setRecords([]); // Clear editable\n        setHistory(allVersions);\n      }\n\n      // üõë Show toast if no results found\n      if (snapshot.empty || allVersions.length === 0) {\n        let msg = \"‚ùå No data found.\";\n        if (searchField === \"Date\") {\n          msg = `‚ùå No data available between ${startDate} and ${endDate}`;\n        } else if (searchField === \"fleetNumber\") {\n          msg = `‚ùå No record found for Fleet Number: ${searchKey}`;\n        } else if (searchField === \"Broker\") {\n          msg = `‚ùå No record found for Broker: ${searchKey}`;\n        }\n        toast.info(msg);\n      }\n    } catch (error) {\n      toast.error(\"‚ùå Search failed: \" + error.message);\n    } finally {\n      setIsSearching(false);\n    }\n  };\n  const ignoredFields = [\"versionDate\", \"expiredAt\", \"isCurrent\", \"updateDescription\", \"createdAt\", \"createdBy\"];\n  const normalize = val => {\n    if (val === null || val === undefined) return \"\";\n    return typeof val === \"object\" && val.seconds ? new Date(val.seconds * 1000).toISOString() : String(val).trim();\n  };\n  const getChangedFields = (current, original) => {\n    const changed = [];\n    for (const key in current) {\n      if (ignoredFields.includes(key)) continue;\n      const currVal = normalize(current[key]);\n      const origVal = normalize(original === null || original === void 0 ? void 0 : original[key]);\n      if (currVal !== origVal) changed.push(key);\n    }\n    return changed;\n  };\n  const hasMeaningfulChanges = (curr, orig) => getChangedFields(curr, orig).length > 0;\n  const handleUpdate = async row => {\n    try {\n      const {\n        id,\n        fleetNumber,\n        ...updatedData\n      } = row;\n      const currentDocSnap = await getDocs(query(collection(db, \"fleet_records\"), where(\"fleetNumber\", \"==\", fleetNumber), where(\"isCurrent\", \"==\", true)));\n      const oldDoc = currentDocSnap.docs.find(doc => doc.id === id);\n      const oldData = (oldDoc === null || oldDoc === void 0 ? void 0 : oldDoc.data()) || {};\n      const cleanData = {};\n      const updateLog = [];\n      const ignoredFields = [\"id\", \"isCurrent\", \"createdAt\", \"createdBy\", \"versionDate\", \"updateDescription\", \"expiredAt\", \"modifiedBy\"];\n      let hasChanged = false;\n      for (const key in updatedData) {\n        var _updatedData$key, _oldData$key;\n        if (ignoredFields.includes(key)) continue;\n        const newVal = (_updatedData$key = updatedData[key]) !== null && _updatedData$key !== void 0 ? _updatedData$key : \"\";\n        const oldVal = (_oldData$key = oldData[key]) !== null && _oldData$key !== void 0 ? _oldData$key : \"\";\n        cleanData[key] = newVal;\n        if (String(newVal).trim() !== String(oldVal).trim() && keyToLabel[key]) {\n          updateLog.push(`Updated ${keyToLabel[key]}`);\n          hasChanged = true;\n        }\n      }\n      if (!hasChanged) {\n        toast.info(\"‚ÑπÔ∏è No changes detected ‚Äî update skipped.\");\n        return;\n      }\n\n      // ‚úÖ Confirmation before updating\n      const confirm = window.confirm(`Are you sure you want to update this record?\\nChanges: ${updateLog.join(\", \")}`);\n      if (!confirm) return;\n      const updateDescription = updateLog.join(\", \");\n      await updateDoc(doc(db, \"fleet_records\", id), {\n        isCurrent: false,\n        expiredAt: new Date(),\n        modifiedBy: user.email\n      });\n      const newVersion = {\n        ...cleanData,\n        fleetNumber,\n        createdAt: new Date(),\n        createdBy: user.email,\n        isCurrent: true,\n        versionDate: new Date(),\n        updateDescription\n      };\n      const docRef = await addDoc(collection(db, \"fleet_records\"), newVersion);\n      const q = query(collection(db, \"fleet_records\"), where(\"fleetNumber\", \"==\", fleetNumber));\n      const snapshot = await getDocs(q);\n      const allVersions = [];\n      const currentOnly = [];\n      snapshot.forEach(docSnap => {\n        const row = {\n          id: docSnap.id,\n          ...docSnap.data()\n        };\n        allVersions.push(row);\n        if (row.isCurrent) currentOnly.push(row);\n      });\n      setHistory(allVersions);\n      setRecords(currentOnly);\n      const originalMap = {};\n      currentOnly.forEach(r => originalMap[r.id] = {\n        ...r\n      });\n      setOriginalRecords(originalMap);\n      toast.success(\"‚úÖ Record updated (SCD Type 2)\");\n    } catch (error) {\n      toast.error(\"‚ùå Update failed: \" + error.message);\n    }\n  };\n  const handleDelete = async fleetNumberToDelete => {\n    try {\n      const q = query(collection(db, \"fleet_records\"), where(\"fleetNumber\", \"==\", fleetNumberToDelete));\n      const snapshot = await getDocs(q);\n      if (snapshot.empty) {\n        alert(\"‚ùå No records found for this fleet number.\");\n        return;\n      }\n      const confirmDelete = window.confirm(`Delete ALL versions for fleet number ${fleetNumberToDelete}?`);\n      if (!confirmDelete) return;\n      const batchDeletes = snapshot.docs.map(docSnap => deleteDoc(doc(db, \"fleet_records\", docSnap.id)));\n      await Promise.all(batchDeletes);\n\n      // Remove from both tables\n      setRecords(prev => prev.filter(r => r.fleetNumber !== fleetNumberToDelete));\n      setHistory(prev => prev.filter(r => r.fleetNumber !== fleetNumberToDelete));\n      alert(`‚úÖ All versions of Fleet Number ${fleetNumberToDelete} deleted.`);\n    } catch (error) {\n      alert(\"‚ùå Delete error: \" + error.message);\n    }\n  };\n  if (!user) return /*#__PURE__*/React.createElement(Auth, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 337,\n      columnNumber: 21\n    }\n  });\n  return /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      maxWidth: \"100vw\",\n      overflowX: \"hidden\",\n      padding: \"40px 20px\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 341,\n      columnNumber: 1\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"header\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 342,\n      columnNumber: 3\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 343,\n      columnNumber: 3\n    }\n  }, \"Fleet Billing Dashboard\"), /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      display: \"flex\",\n      alignItems: \"center\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 344,\n      columnNumber: 3\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: \"user-email\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 345,\n      columnNumber: 5\n    }\n  }, \"Welcome, \", user.email), /*#__PURE__*/React.createElement(\"img\", {\n    src: \"/logo.png\",\n    alt: \"Logo\",\n    style: {\n      height: \"50px\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 346,\n      columnNumber: 5\n    }\n  }))), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: () => signOut(auth),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 352,\n      columnNumber: 7\n    }\n  }, \"Logout\"), /*#__PURE__*/React.createElement(\"hr\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 353,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(UploadForm, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 354,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(ManualEntryForm, {\n    onAddRow: (row, addToHistory) => {\n      setRecords([row]);\n      if (addToHistory) setHistory([row]);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 355,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"hr\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 363,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"h4\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 364,\n      columnNumber: 6\n    }\n  }, \"Search Existing Records\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"search-bar\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 365,\n      columnNumber: 6\n    }\n  }, /*#__PURE__*/React.createElement(\"select\", {\n    value: searchField,\n    onChange: e => {\n      setSearchField(e.target.value);\n      setSearchKey(\"\");\n      setStartDate(\"\");\n      setEndDate(\"\");\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 366,\n      columnNumber: 1\n    }\n  }, /*#__PURE__*/React.createElement(\"option\", {\n    value: \"fleetNumber\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 372,\n      columnNumber: 3\n    }\n  }, \"Fleet Number\"), /*#__PURE__*/React.createElement(\"option\", {\n    value: \"Broker\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 373,\n      columnNumber: 3\n    }\n  }, \"Broker\"), /*#__PURE__*/React.createElement(\"option\", {\n    value: \"Date\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 374,\n      columnNumber: 3\n    }\n  }, \"Date\")), searchField === \"Date\" ? /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"label\", {\n    style: {\n      marginLeft: 10\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 379,\n      columnNumber: 5\n    }\n  }, \"From:\"), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"date\",\n    value: startDate,\n    onChange: e => setStartDate(e.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 380,\n      columnNumber: 5\n    }\n  }), /*#__PURE__*/React.createElement(\"label\", {\n    style: {\n      marginLeft: 10\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 381,\n      columnNumber: 5\n    }\n  }, \"To:\"), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"date\",\n    value: endDate,\n    onChange: e => setEndDate(e.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 382,\n      columnNumber: 5\n    }\n  })) : /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    value: searchKey,\n    onChange: e => setSearchKey(e.target.value),\n    placeholder: \"Search key\",\n    style: {\n      margin: \"0 10px\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 385,\n      columnNumber: 3\n    }\n  }), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: handleSearch,\n    style: {\n      marginLeft: 10\n    },\n    disabled: isSearching,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 394,\n      columnNumber: 1\n    }\n  }, isSearching ? /*#__PURE__*/React.createElement(React.Fragment, null, \"Searching... \", /*#__PURE__*/React.createElement(\"span\", {\n    className: \"loader-spinner\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 397,\n      columnNumber: 20\n    }\n  })) : \"Search\")), /*#__PURE__*/React.createElement(\"hr\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 406,\n      columnNumber: 7\n    }\n  }), searchField === \"fleetNumber\" && records.length > 0 && /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"h4\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 409,\n      columnNumber: 7\n    }\n  }, \"Editable Current Records\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"table-scroll-x\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 410,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"table\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 411,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"thead\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 412,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"tr\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 413,\n      columnNumber: 11\n    }\n  }, [\"Fleet Number\", ...Object.keys(labelToKey).filter(l => l !== \"Fleet Number\").sort()].map(label => /*#__PURE__*/React.createElement(\"th\", {\n    key: label,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 415,\n      columnNumber: 15\n    }\n  }, label)), /*#__PURE__*/React.createElement(\"th\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 417,\n      columnNumber: 13\n    }\n  }, \"Action\"))), /*#__PURE__*/React.createElement(\"tbody\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 420,\n      columnNumber: 9\n    }\n  }, records.map((row, rowIndex) => {\n    const readOnly = [\"fleetNumber\", \"createdAt\", \"createdBy\", \"isCurrent\", \"updateDescription\"];\n    return /*#__PURE__*/React.createElement(\"tr\", {\n      key: rowIndex,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 424,\n        columnNumber: 15\n      }\n    }, [\"Fleet Number\", ...Object.keys(labelToKey).filter(l => l !== \"Fleet Number\").sort()].map(label => {\n      var _row$key, _row$key2;\n      const key = labelToKey[label];\n      return /*#__PURE__*/React.createElement(\"td\", {\n        key: key,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 428,\n          columnNumber: 5\n        }\n      }, /*#__PURE__*/React.createElement(\"input\", {\n        type: \"text\",\n        value: typeof row[key] === \"object\" && ((_row$key = row[key]) === null || _row$key === void 0 ? void 0 : _row$key.seconds) ? new Date(row[key].seconds * 1000).toLocaleString() : String((_row$key2 = row[key]) !== null && _row$key2 !== void 0 ? _row$key2 : \"\"),\n        onChange: e => {\n          const updated = [...records];\n          updated[rowIndex][key] = e.target.value;\n          setRecords(updated);\n        },\n        readOnly: [\"fleetNumber\", \"createdAt\", \"createdBy\", \"isCurrent\", \"updateDescription\"].includes(key),\n        style: {\n          width: \"120px\"\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 429,\n          columnNumber: 7\n        }\n      }));\n    }), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 449,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      className: \"save\",\n      disabled: !hasMeaningfulChanges(row, originalRecords[row.id]),\n      onClick: () => handleUpdate(row),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 450,\n        columnNumber: 18\n      }\n    }, \"Save\"), /*#__PURE__*/React.createElement(\"button\", {\n      className: \"delete\",\n      onClick: () => handleDelete(row.fleetNumber),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 458,\n        columnNumber: 1\n      }\n    }, \"Delete\")));\n  }))))), history.length > 0 && /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"hr\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 478,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(\"h4\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 479,\n      columnNumber: 11\n    }\n  }, \"\\uD83D\\uDD0D Full Version History\"), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: handleExport,\n    disabled: isExporting,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 480,\n      columnNumber: 11\n    }\n  }, \"\\uD83D\\uDCC4 Export to Excel\", isExporting && /*#__PURE__*/React.createElement(\"span\", {\n    className: \"loader-spinner\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 482,\n      columnNumber: 19\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"table-scroll-x\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 485,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"table\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 486,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"thead\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 487,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"tr\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 488,\n      columnNumber: 17\n    }\n  }, [\"fleetNumber\", ...[...new Set(history.flatMap(Object.keys))].filter(col => col !== \"fleetNumber\").sort()].map(col => /*#__PURE__*/React.createElement(\"th\", {\n    key: col,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 492,\n      columnNumber: 21\n    }\n  }, col)))), /*#__PURE__*/React.createElement(\"tbody\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 496,\n      columnNumber: 15\n    }\n  }, [...history].sort((a, b) => {\n    var _a$expiredAt, _b$expiredAt;\n    if (a.isCurrent) return -1;\n    if (b.isCurrent) return 1;\n    const aTime = ((_a$expiredAt = a.expiredAt) === null || _a$expiredAt === void 0 ? void 0 : _a$expiredAt.seconds) || 0;\n    const bTime = ((_b$expiredAt = b.expiredAt) === null || _b$expiredAt === void 0 ? void 0 : _b$expiredAt.seconds) || 0;\n    return bTime - aTime;\n  }).map((row, i) => /*#__PURE__*/React.createElement(\"tr\", {\n    key: i,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 506,\n      columnNumber: 21\n    }\n  }, [\"fleetNumber\", ...[...new Set(history.flatMap(Object.keys))].filter(col => col !== \"fleetNumber\").sort()].map((col, j) => {\n    var _row$col, _row$col2;\n    return /*#__PURE__*/React.createElement(\"td\", {\n      key: j,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 510,\n        columnNumber: 5\n      }\n    }, typeof row[col] === \"object\" && ((_row$col = row[col]) === null || _row$col === void 0 ? void 0 : _row$col.seconds) ? new Date(row[col].seconds * 1000).toLocaleString() : String((_row$col2 = row[col]) !== null && _row$col2 !== void 0 ? _row$col2 : \"\"));\n  }))))))), searchAttempted && !isSearching && records.length === 0 && history.length === 0 && /*#__PURE__*/React.createElement(\"p\", {\n    style: {\n      textAlign: \"center\",\n      color: \"#888\",\n      marginTop: \"30px\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 525,\n      columnNumber: 3\n    }\n  }, \"No records to display.\"), /*#__PURE__*/React.createElement(ToastContainer, {\n    position: \"bottom-right\",\n    autoClose: 3000,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 529,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"p\", {\n    style: {\n      textAlign: \"center\",\n      marginTop: \"30px\",\n      color: \"#666\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 530,\n      columnNumber: 7\n    }\n  }, \"\\xA9 2025 Fleet Billing System\"));\n}\nexport default App;","map":{"version":3,"names":["React","useEffect","useState","onAuthStateChanged","signOut","collection","addDoc","query","where","getDocs","getDoc","updateDoc","deleteDoc","doc","auth","db","Auth","UploadForm","ManualEntryForm","toast","ToastContainer","labelToKey","keyToLabel","Object","fromEntries","entries","map","k","v","App","user","setUser","records","setRecords","history","setHistory","searchKey","setSearchKey","searchField","setSearchField","startDate","setStartDate","endDate","setEndDate","originalRecords","setOriginalRecords","isSearching","setIsSearching","isExporting","setIsExporting","searchAttempted","setSearchAttempted","unsubscribe","currentUser","handleExport","info","then","xlsx","rows","row","flatRow","keys","forEach","value","seconds","Date","toLocaleString","String","worksheet","utils","json_to_sheet","workbook","book_new","book_append_sheet","writeFile","success","catch","err","error","message","finally","handleSearch","fleetRef","q","warn","fromDate","toDate","key","Number","snapshot","allVersions","currentOnly","docSnap","id","data","push","isCurrent","empty","length","msg","ignoredFields","normalize","val","undefined","toISOString","trim","getChangedFields","current","original","changed","includes","currVal","origVal","hasMeaningfulChanges","curr","orig","handleUpdate","fleetNumber","updatedData","currentDocSnap","oldDoc","docs","find","oldData","cleanData","updateLog","hasChanged","_updatedData$key","_oldData$key","newVal","oldVal","confirm","window","join","updateDescription","expiredAt","modifiedBy","email","newVersion","createdAt","createdBy","versionDate","docRef","originalMap","r","handleDelete","fleetNumberToDelete","alert","confirmDelete","batchDeletes","Promise","all","prev","filter","createElement","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","style","maxWidth","overflowX","padding","className","display","alignItems","src","alt","height","onClick","onAddRow","addToHistory","onChange","e","target","Fragment","marginLeft","type","placeholder","margin","disabled","l","sort","label","rowIndex","readOnly","_row$key","_row$key2","updated","width","Set","flatMap","col","a","b","_a$expiredAt","_b$expiredAt","aTime","bTime","i","j","_row$col","_row$col2","textAlign","color","marginTop","position","autoClose"],"sources":["C:/Users/anupp/Downloads/fleet-billing-app/fleet-billing-app/src/App.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport { onAuthStateChanged, signOut } from \"firebase/auth\";\r\nimport {\r\n  collection,\r\n  addDoc,\r\n  query,\r\n  where,\r\n  getDocs,\r\n  getDoc,\r\n  updateDoc,\r\n  deleteDoc,\r\n  doc\r\n} from \"firebase/firestore\";\r\nimport { auth, db } from \"./firebase\";\r\nimport Auth from \"./components/Auth\";\r\nimport UploadForm from \"./components/UploadForm\";\r\nimport ManualEntryForm from \"./components/ManualEntryForm\";\r\nimport \"./App.css\";\r\nimport { toast, ToastContainer } from \"react-toastify\";\r\nimport \"react-toastify/dist/ReactToastify.css\";\r\n\r\n\r\n\r\n\r\nconst labelToKey = {\r\n  \"Fleet Number\": \"fleetNumber\",\r\n  \"Indent No\": \"IndentNo\", \"Indent Date\": \"IndentDate\", \"Placement Date\": \"PlacementDate\",\r\n  \"Customer\": \"Customer\", \"Customer Type\": \"CustomerType\", \"Customer Billing Type\": \"CustomerBillingType\",\r\n  \"Sourcing (Vendor)\": \"SourcingVendor\", \"Vendor Type\": \"VendorType\", \"Vendor Billing Type\": \"VendorBillingType\",\r\n  \"Origin\": \"Origin\", \"Destination\": \"Destination\", \"Vehicle No\": \"VehicleNo\", \"Vehicle type\": \"VehicleType\",\r\n  \"Driver No\": \"DriverNo\", \"Dispatch Date\": \"DispatchDate\", \"Deliver Date\": \"DeliverDate\",\r\n  \"Offloading Date\": \"OffloadingDate\", \"E-way Bill\": \"EwayBill\", \"LR No.\": \"LRNo\",\r\n  \"Soft Copy POD Rec\": \"SoftCopyPODRec\", \"Hard Copy POD Rec\": \"HardCopyPODRec\", \"Customer -Sale rate\": \"CustomerSaleRate\",\r\n  \"Advance to be Paid\": \"AdvanceToBePaid\", \"Advance Rec\": \"AdvanceRec\", \"Advance UTR\": \"AdvanceUTR\",\r\n  \"Advance Rec-Date\": \"AdvanceRecDate\", \"Balance Pending\": \"BalancePending\", \"Detention Charges\": \"DetentionCharges\",\r\n  \"Loading/Unloading Charges\": \"LoadingUnloadingCharges\", \"Miscellaneous Charges.\": \"MiscCharges\",\r\n  \"Processing Charges\": \"ProcessingCharges\", \"Net Balance\": \"NetBalance\", \"Balance Rec Amount\": \"BalanceRecAmount\",\r\n  \"Balance UTR\": \"BalanceUTR\", \"Balance Rec Date\": \"BalanceRecDate\", \"Remaining Balance\": \"RemainingBalance\",\r\n  \"Remaining Balance UTR\": \"RemainingBalanceUTR\", \"Remaining Balance Date\": \"RemainingBalanceDate\",\r\n  \"Supplier Buy Rate\": \"SupplierBuyRate\", \"Supplier Advance Pay\": \"SupplierAdvancePay\",\r\n  \"Supplier Advance Paid\": \"SupplierAdvancePaid\", \"Supplier Mis Charges\": \"SupplierMisCharges\",\r\n  \"Supplier Invoice No.\": \"SupplierInvoiceNo\", \"Supplier Advance UTR\": \"SupplierAdvanceUTR\",\r\n  \"Supplier Advance Pay-Date\": \"SupplierAdvancePayDate\", \"Supplier Balance Pending\": \"SupplierBalancePending\",\r\n  \"Supplier Balance Paid Amount\": \"SupplierBalancePaidAmount\", \"Supplier Balance Paid UTR\": \"SupplierBalancePaidUTR\",\r\n  \"Supplier Balance Paid Date\": \"SupplierBalancePaidDate\", \"Remaining Supplier Amount\": \"RemainingSupplierAmount\",\r\n  \"POD Rec Date\": \"PODRecDate\", \"POD Send to Customer Date\": \"PODSendToCustomerDate\",\r\n  \"POD Docket No.\": \"PODDocketNo\", \"POD Rec By Customer\": \"PODRecByCustomer\", \"POD Deduction If any\": \"PODDeductionIfAny\",\r\n  \"Gross Profit\": \"GrossProfit\", \"Bad Debts\": \"BadDebts\", \"Net Profit\": \"NetProfit\",\r\n  \"isCurrent\": \"isCurrent\", \"createdBy\": \"createdBy\", \"createdAt\": \"createdAt\", \"Update Description\": \"updateDescription\"\r\n};\r\n\r\nconst keyToLabel = Object.fromEntries(Object.entries(labelToKey).map(([k, v]) => [v, k]));\r\n\r\n\r\nfunction App() {\r\n  const [user, setUser] = useState(null);\r\n  const [records, setRecords] = useState([]);\r\n  const [history, setHistory] = useState([]);\r\n  const [searchKey, setSearchKey] = useState(\"\");\r\n  const [searchField, setSearchField] = useState(\"fleetNumber\");\r\n  const [startDate, setStartDate] = useState(\"\");\r\n  const [endDate, setEndDate] = useState(\"\");\r\n  const [originalRecords, setOriginalRecords] = useState({});\r\n  const [isSearching, setIsSearching] = useState(false);\r\n  const [isExporting, setIsExporting] = useState(false);\r\n  const [searchAttempted, setSearchAttempted] = useState(false);\r\n\r\n\r\n\r\n\r\n\r\n  useEffect(() => {\r\n    const unsubscribe = onAuthStateChanged(auth, (currentUser) => {\r\n      setUser(currentUser);\r\n    });\r\n    return () => unsubscribe();\r\n  }, []);\r\n\r\n  // const handleExport = () => {\r\n  //   import(\"xlsx\").then((xlsx) => {\r\n  //     const rows = history.map((row) => {\r\n  //       const flatRow = {};\r\n  //       Object.keys(row).forEach((k) => {\r\n  //         const value = row[k];\r\n  //         flatRow[k] =\r\n  //           typeof value === \"object\" && value?.seconds\r\n  //             ? new Date(value.seconds * 1000).toLocaleString()\r\n  //             : String(value ?? \"\");\r\n  //       });\r\n  //       return flatRow;\r\n  //     });\r\n\r\n  //     const worksheet = xlsx.utils.json_to_sheet(rows);\r\n  //     const workbook = xlsx.utils.book_new();\r\n  //     xlsx.utils.book_append_sheet(workbook, worksheet, \"History\");\r\n  //     xlsx.writeFile(workbook, \"Fleet_Full_Version_History.xlsx\");\r\n  //   });\r\n  // };\r\nconst handleExport = () => {\r\n  setIsExporting(true);\r\n  toast.info(\"‚è≥ Preparing Excel export...\");\r\n\r\n  import(\"xlsx\").then((xlsx) => {\r\n    const rows = history.map((row) => {\r\n      const flatRow = {};\r\n      Object.keys(row).forEach((k) => {\r\n        const value = row[k];\r\n        flatRow[k] =\r\n          typeof value === \"object\" && value?.seconds\r\n            ? new Date(value.seconds * 1000).toLocaleString()\r\n            : String(value ?? \"\");\r\n      });\r\n      return flatRow;\r\n    });\r\n\r\n    const worksheet = xlsx.utils.json_to_sheet(rows);\r\n    const workbook = xlsx.utils.book_new();\r\n    xlsx.utils.book_append_sheet(workbook, worksheet, \"History\");\r\n    xlsx.writeFile(workbook, \"Fleet_Full_Version_History.xlsx\");\r\n\r\n    toast.success(\"‚úÖ Export complete.\");\r\n  }).catch((err) => {\r\n    toast.error(\"‚ùå Export failed: \" + err.message);\r\n  }).finally(() => {\r\n    setIsExporting(false);\r\n  });\r\n};\r\n\r\n\r\n\r\nconst handleSearch = async () => {\r\n  setIsSearching(true);\r\n  try {\r\n    const fleetRef = collection(db, \"fleet_records\");\r\n    let q;\r\n\r\n    if (searchField === \"Date\") {\r\n      if (!startDate || !endDate) {\r\n        toast.warn(\"üìÖ Please select both From and To dates.\");\r\n        setIsSearching(false);\r\n        return;\r\n      }\r\n\r\n      const fromDate = new Date(startDate);\r\n      const toDate = new Date(endDate + \"T23:59:59\");\r\n\r\n      if (fromDate > toDate) {\r\n        toast.warn(\"‚ö†Ô∏è 'From' date cannot be after 'To' date.\");\r\n        setIsSearching(false);\r\n        return;\r\n      }\r\n\r\n      q = query(fleetRef, where(\"createdAt\", \">=\", fromDate), where(\"createdAt\", \"<=\", toDate));\r\n    } else if (searchKey) {\r\n      const key = searchField === \"fleetNumber\" ? Number(searchKey) : searchKey;\r\n      q = query(fleetRef, where(searchField, \"==\", key));\r\n    } else {\r\n      toast.warn(\"üîç Please enter a search value.\");\r\n      setIsSearching(false);\r\n      return;\r\n    }\r\n    setSearchAttempted(true);\r\n    const snapshot = await getDocs(q);\r\n    const allVersions = [];\r\n    const currentOnly = [];\r\n\r\n    snapshot.forEach((docSnap) => {\r\n      const row = { id: docSnap.id, ...docSnap.data() };\r\n      allVersions.push(row);\r\n      if (row.isCurrent) currentOnly.push(row);\r\n    });\r\n\r\nif (searchField === \"fleetNumber\" || searchField === \"Broker\") {\r\n  setRecords(currentOnly);\r\n  setHistory(allVersions);\r\n} else if (searchField === \"Date\") {\r\n  setRecords([]); // Clear editable\r\n  setHistory(allVersions);\r\n}\r\n\r\n\r\n    // üõë Show toast if no results found\r\n    if (snapshot.empty || allVersions.length === 0) {\r\n      let msg = \"‚ùå No data found.\";\r\n      if (searchField === \"Date\") {\r\n        msg = `‚ùå No data available between ${startDate} and ${endDate}`;\r\n      } else if (searchField === \"fleetNumber\") {\r\n        msg = `‚ùå No record found for Fleet Number: ${searchKey}`;\r\n      } else if (searchField === \"Broker\") {\r\n        msg = `‚ùå No record found for Broker: ${searchKey}`;\r\n      }\r\n      toast.info(msg);\r\n    }\r\n\r\n  } catch (error) {\r\n    toast.error(\"‚ùå Search failed: \" + error.message);\r\n  } finally {\r\n    setIsSearching(false);\r\n  }\r\n};\r\n\r\n\r\nconst ignoredFields = [\"versionDate\", \"expiredAt\", \"isCurrent\", \"updateDescription\", \"createdAt\", \"createdBy\"];\r\n\r\nconst normalize = (val) => {\r\n  if (val === null || val === undefined) return \"\";\r\n  return typeof val === \"object\" && val.seconds\r\n    ? new Date(val.seconds * 1000).toISOString()\r\n    : String(val).trim();\r\n};\r\n\r\nconst getChangedFields = (current, original) => {\r\n  const changed = [];\r\n  for (const key in current) {\r\n    if (ignoredFields.includes(key)) continue;\r\n    const currVal = normalize(current[key]);\r\n    const origVal = normalize(original?.[key]);\r\n    if (currVal !== origVal) changed.push(key);\r\n  }\r\n  return changed;\r\n};\r\n\r\nconst hasMeaningfulChanges = (curr, orig) => getChangedFields(curr, orig).length > 0;\r\n\r\n\r\nconst handleUpdate = async (row) => {\r\n  try {\r\n    const { id, fleetNumber, ...updatedData } = row;\r\n\r\n    const currentDocSnap = await getDocs(\r\n      query(collection(db, \"fleet_records\"), where(\"fleetNumber\", \"==\", fleetNumber), where(\"isCurrent\", \"==\", true))\r\n    );\r\n    const oldDoc = currentDocSnap.docs.find(doc => doc.id === id);\r\n    const oldData = oldDoc?.data() || {};\r\n\r\n    const cleanData = {};\r\n    const updateLog = [];\r\n    const ignoredFields = [\"id\", \"isCurrent\", \"createdAt\", \"createdBy\", \"versionDate\", \"updateDescription\", \"expiredAt\", \"modifiedBy\"];\r\n\r\n    let hasChanged = false;\r\n\r\n    for (const key in updatedData) {\r\n      if (ignoredFields.includes(key)) continue;\r\n\r\n      const newVal = updatedData[key] ?? \"\";\r\n      const oldVal = oldData[key] ?? \"\";\r\n\r\n      cleanData[key] = newVal;\r\n\r\n      if (String(newVal).trim() !== String(oldVal).trim() && keyToLabel[key]) {\r\n        updateLog.push(`Updated ${keyToLabel[key]}`);\r\n        hasChanged = true;\r\n      }\r\n    }\r\n\r\n    if (!hasChanged) {\r\n      toast.info(\"‚ÑπÔ∏è No changes detected ‚Äî update skipped.\");\r\n      return;\r\n    }\r\n\r\n    // ‚úÖ Confirmation before updating\r\n    const confirm = window.confirm(`Are you sure you want to update this record?\\nChanges: ${updateLog.join(\", \")}`);\r\n    if (!confirm) return;\r\n\r\n    const updateDescription = updateLog.join(\", \");\r\n\r\n    await updateDoc(doc(db, \"fleet_records\", id), {\r\n      isCurrent: false,\r\n      expiredAt: new Date(),\r\n      modifiedBy: user.email\r\n    });\r\n\r\n    const newVersion = {\r\n      ...cleanData,\r\n      fleetNumber,\r\n      createdAt: new Date(),\r\n      createdBy: user.email,\r\n      isCurrent: true,\r\n      versionDate: new Date(),\r\n      updateDescription\r\n    };\r\n\r\n    const docRef = await addDoc(collection(db, \"fleet_records\"), newVersion);\r\n\r\n    const q = query(collection(db, \"fleet_records\"), where(\"fleetNumber\", \"==\", fleetNumber));\r\n    const snapshot = await getDocs(q);\r\n    const allVersions = [];\r\n    const currentOnly = [];\r\n\r\n    snapshot.forEach((docSnap) => {\r\n      const row = { id: docSnap.id, ...docSnap.data() };\r\n      allVersions.push(row);\r\n      if (row.isCurrent) currentOnly.push(row);\r\n    });\r\n\r\n    setHistory(allVersions);\r\n    setRecords(currentOnly);\r\n\r\n    const originalMap = {};\r\n    currentOnly.forEach((r) => originalMap[r.id] = { ...r });\r\n    setOriginalRecords(originalMap);\r\n\r\n    toast.success(\"‚úÖ Record updated (SCD Type 2)\");\r\n  } catch (error) {\r\n    toast.error(\"‚ùå Update failed: \" + error.message);\r\n  }\r\n};\r\n\r\n\r\nconst handleDelete = async (fleetNumberToDelete) => {\r\n  try {\r\n    const q = query(collection(db, \"fleet_records\"), where(\"fleetNumber\", \"==\", fleetNumberToDelete));\r\n    const snapshot = await getDocs(q);\r\n\r\n    if (snapshot.empty) {\r\n      alert(\"‚ùå No records found for this fleet number.\");\r\n      return;\r\n    }\r\n\r\n    const confirmDelete = window.confirm(`Delete ALL versions for fleet number ${fleetNumberToDelete}?`);\r\n    if (!confirmDelete) return;\r\n\r\n    const batchDeletes = snapshot.docs.map(docSnap => deleteDoc(doc(db, \"fleet_records\", docSnap.id)));\r\n    await Promise.all(batchDeletes);\r\n\r\n    // Remove from both tables\r\n    setRecords(prev => prev.filter(r => r.fleetNumber !== fleetNumberToDelete));\r\n    setHistory(prev => prev.filter(r => r.fleetNumber !== fleetNumberToDelete));\r\n\r\n    alert(`‚úÖ All versions of Fleet Number ${fleetNumberToDelete} deleted.`);\r\n  } catch (error) {\r\n    alert(\"‚ùå Delete error: \" + error.message);\r\n  }\r\n};\r\n\r\n\r\n  if (!user) return <Auth />;\r\n\r\n  return (\r\n    \r\n<div style={{ maxWidth: \"100vw\", overflowX: \"hidden\", padding: \"40px 20px\" }}>\r\n  <div className=\"header\">\r\n  <h2>Fleet Billing Dashboard</h2>\r\n  <div style={{ display: \"flex\", alignItems: \"center\" }}>\r\n    <span className=\"user-email\">Welcome, {user.email}</span>\r\n    <img src=\"/logo.png\" alt=\"Logo\" style={{ height: \"50px\" }} />\r\n  </div>\r\n</div>\r\n\r\n\r\n\r\n      <button onClick={() => signOut(auth)}>Logout</button>\r\n      <hr />\r\n      <UploadForm />\r\n      <ManualEntryForm\r\n  onAddRow={(row, addToHistory) => {\r\n    setRecords([row]);\r\n    if (addToHistory) setHistory([row]);\r\n  }}\r\n/>\r\n\r\n\r\n      <hr />\r\n     <h4>Search Existing Records</h4>\r\n     <div className=\"search-bar\">\r\n<select value={searchField} onChange={(e) => {\r\n  setSearchField(e.target.value);\r\n  setSearchKey(\"\");\r\n  setStartDate(\"\");\r\n  setEndDate(\"\");\r\n}}>\r\n  <option value=\"fleetNumber\">Fleet Number</option>\r\n  <option value=\"Broker\">Broker</option>\r\n  <option value=\"Date\">Date</option>\r\n</select>\r\n\r\n{searchField === \"Date\" ? (\r\n  <>\r\n    <label style={{ marginLeft: 10 }}>From:</label>\r\n    <input type=\"date\" value={startDate} onChange={(e) => setStartDate(e.target.value)} />\r\n    <label style={{ marginLeft: 10 }}>To:</label>\r\n    <input type=\"date\" value={endDate} onChange={(e) => setEndDate(e.target.value)} />\r\n  </>\r\n) : (\r\n  <input\r\n    type=\"text\"\r\n    value={searchKey}\r\n    onChange={(e) => setSearchKey(e.target.value)}\r\n    placeholder=\"Search key\"\r\n    style={{ margin: \"0 10px\" }}\r\n  />\r\n)}\r\n\r\n<button onClick={handleSearch} style={{ marginLeft: 10 }} disabled={isSearching}>\r\n  {isSearching ? (\r\n    <>\r\n      Searching... <span className=\"loader-spinner\" />\r\n    </>\r\n  ) : (\r\n    \"Search\"\r\n  )}\r\n</button>\r\n\r\n</div>\r\n\r\n      <hr />\r\n      {searchField === \"fleetNumber\" && records.length > 0 && (\r\n      <>\r\n      <h4>Editable Current Records</h4>\r\n    <div className=\"table-scroll-x\">\r\n      <table>\r\n        <thead>\r\n          <tr>\r\n            {[\"Fleet Number\", ...Object.keys(labelToKey).filter(l => l !== \"Fleet Number\").sort()].map((label) => (\r\n              <th key={label}>{label}</th>\r\n            ))}\r\n            <th>Action</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {records.map((row, rowIndex) => {\r\n            const readOnly = [\"fleetNumber\", \"createdAt\", \"createdBy\", \"isCurrent\", \"updateDescription\"];\r\n            return (\r\n              <tr key={rowIndex}>\r\n                {[\"Fleet Number\", ...Object.keys(labelToKey).filter(l => l !== \"Fleet Number\").sort()].map((label) => {\r\n  const key = labelToKey[label];\r\n  return (\r\n    <td key={key}>\r\n      <input\r\n        type=\"text\"\r\n        value={\r\n          typeof row[key] === \"object\" && row[key]?.seconds\r\n            ? new Date(row[key].seconds * 1000).toLocaleString()\r\n            : String(row[key] ?? \"\")\r\n        }\r\n        onChange={(e) => {\r\n          const updated = [...records];\r\n          updated[rowIndex][key] = e.target.value;\r\n          setRecords(updated);\r\n        }}\r\n        readOnly={[\"fleetNumber\", \"createdAt\", \"createdBy\", \"isCurrent\",\"updateDescription\"].includes(key)}\r\n        style={{ width: \"120px\" }}\r\n      />\r\n    </td>\r\n  );\r\n})}\r\n\r\n                \r\n                <td>\r\n                 <button\r\n  className=\"save\"\r\n  disabled={!hasMeaningfulChanges(row, originalRecords[row.id])}\r\n  onClick={() => handleUpdate(row)}\r\n>\r\n  Save\r\n</button>\r\n\r\n<button\r\n  className=\"delete\"\r\n  onClick={() => handleDelete(row.fleetNumber)}\r\n>\r\n  Delete\r\n</button>\r\n\r\n\r\n                </td>\r\n              </tr>\r\n            );\r\n          })}\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n  </>\r\n)}\r\n\r\n      {history.length > 0 && (\r\n        <>\r\n          <hr />\r\n          <h4>üîç Full Version History</h4>\r\n          <button onClick={handleExport} disabled={isExporting}>\r\n  üìÑ Export to Excel\r\n  {isExporting && <span className=\"loader-spinner\" />}\r\n</button>\r\n\r\n          <div className=\"table-scroll-x\">\r\n            <table>\r\n              <thead>\r\n                <tr>\r\n                  {[\"fleetNumber\", ...[...new Set(history.flatMap(Object.keys))]\r\n                      .filter(col => col !== \"fleetNumber\")\r\n                    .sort()].map((col) => (\r\n                    <th key={col}>{col}</th>\r\n                  ))}\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                {[...history]\r\n                  .sort((a, b) => {\r\n                    if (a.isCurrent) return -1;\r\n                    if (b.isCurrent) return 1;\r\n                    const aTime = a.expiredAt?.seconds || 0;\r\n                    const bTime = b.expiredAt?.seconds || 0;\r\n                    return bTime - aTime;\r\n                  })\r\n                  .map((row, i) => (\r\n                    <tr key={i}>\r\n                      {[\"fleetNumber\", ...[...new Set(history.flatMap(Object.keys))]\r\n  .filter(col => col !== \"fleetNumber\")\r\n  .sort()].map((col, j) => (\r\n    <td key={j}>\r\n      {typeof row[col] === \"object\" && row[col]?.seconds\r\n        ? new Date(row[col].seconds * 1000).toLocaleString()\r\n        : String(row[col] ?? \"\")}\r\n    </td>\r\n))}\r\n\r\n                    </tr>\r\n                  ))}\r\n              </tbody>\r\n            </table>\r\n          </div>  \r\n        </>\r\n      )}\r\n      {searchAttempted && !isSearching && records.length === 0 && history.length === 0 && (\r\n  <p style={{ textAlign: \"center\", color: \"#888\", marginTop: \"30px\" }}>\r\n    No records to display.\r\n  </p>\r\n)}\r\n      <ToastContainer position=\"bottom-right\" autoClose={3000} />\r\n      <p style={{ textAlign: \"center\", marginTop: \"30px\", color: \"#666\" }}>\r\n  ¬© 2025 Fleet Billing System\r\n</p>\r\n\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}